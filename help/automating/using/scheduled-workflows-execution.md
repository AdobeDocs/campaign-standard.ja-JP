---
title: スケジュールされたワークフローの重複実行
description: スケジュールされたワークフローが重複して実行されるのを防ぐ方法を説明します。
audience: automating
content-type: reference
topic-tags: workflow-general-operation
context-tags: workflow,overview;workflow,main
feature: Workflows
role: Data Architect
level: Intermediate
exl-id: 8d9820a4-3c44-45f5-815e-4ed48a96276d
source-git-commit: fcb5c4a92f23bdffd1082b7b044b5859dead9d70
workflow-type: tm+mt
source-wordcount: '422'
ht-degree: 1%

---

# スケジュールされたワークフローの重複実行{#preventing-overlapping-execution-of-scheduled-workflows}

## スケジュールされたワークフローの実行について

Campaign Standardでは、ワークフローエンジンによって、1 つのプロセスのみで 1 つのワークフローインスタンスが実行されることが保証されます。 インポート、長時間実行されるクエリ、データベースへの書き込みなどのアクティビティをブロックすると、実行時に他のタスクが実行されなくなります。

一方、非ブロックアクティビティは、他のタスク ( 通常、 **[!UICONTROL Scheduler]** アクティビティ )。

これにより、同じワークフローの以前の実行がまだ完了していない場合でも、スケジュールベースのワークフローの実行が開始し、予期しないデータの問題が発生する可能性があります。

したがって、複数のアクティビティを含むスケジュール済みワークフローをデザインする場合は、ワークフローが完了するまで再スケジュールされないようにする必要があります。 これをおこなうには、以前の実行の 1 つ以上のタスクがまだ保留中の場合に、実行を防ぐようにワークフローを設定する必要があります。

## ワークフローの設定

前回のワークフロー実行の 1 つ以上のタスクがまだ保留中かどうかを確認するには、 **[!UICONTROL Query]** および **[!UICONTROL Test]** アクティビティ。

1. を追加します。 **[!UICONTROL Query]** アクティビティ **[!UICONTROL Scheduler]** 「 」アクティビティを開き、次のように設定します。

1. アクティビティのリソースをに変更します。 **[!UICONTROL WorkflowTaskDetail]**&#x200B;ワークフローの現在のタスクをターゲットにします。

   ![](assets/scheduled-wkf-resource.png)

1. 次のルールを使用してクエリを設定します。

   ![](assets/scheduled-wkf-query.png)

   * 最初のルールは、現在のタスク（クエリ 2）と、現在のワークフローに属する次のスケジュールタスク（スケジュール 2）を除外します。

      >[!NOTE]
      >
      >When a **[!UICONTROL Scheduler]** 「 」アクティビティが開始されると、すぐに別のスケジュールタスクが追加され、次のスケジュール時刻に実行され、ワークフローが開始されます。 したがって、前回の実行から保留中のタスクを検索する場合は、クエリとスケジュールタスクの両方をフィルタリングすることが重要です。

   * 2 つ目のルールは、前回のワークフロー実行のタスクが、0 個の実行ステータスに対応する、アクティブ（保留中）であるかどうかを判定します。

1. を追加します。 **[!UICONTROL Test]** アクティビティを使用して、 **[!UICONTROL Query]** アクティビティ。 これをおこなうには、2 つのアウトバウンドトランジションを設定します。

   ![](assets/scheduled-wkf-test.png)

   * 保留中のタスクがない場合、最初のトランジションはワークフローの実行を継続します。
   * 2 つ目のトランジションは、保留中のタスクがある場合に、ワークフローの実行をキャンセルします。

   ![](assets/scheduled-wkf-workflow.png)

これで、必要に応じて、残りのワークフローを設定できます。 保留中のタスクが原因でワークフローの実行がキャンセルされた場合、スケジュールに従ってワークフローが再度実行されると、以下の手順を実行できます。 これにより、前回の実行からアクティブな（保留中の）タスクがない場合にのみ、ワークフローの実行が続行されます。
