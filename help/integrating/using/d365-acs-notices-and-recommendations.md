---
solution: Campaign Standard
product: campaign
title: CampaignとMicrosoft Dynamics 365のデータ管理
description: Campaign StandardとMicrosoft Dynamics 365で共通データを管理する方法を説明します
audience: integrating
content-type: reference
topic-tags: working-with-campaign-and-ms-dynamics
feature: Microsoft CRM統合
role: Data Architect
level: Experienced
exl-id: aab6f005-f3da-4c0b-b856-da8504e611dc
source-git-commit: f28aab2ac295d8a45598f5d76a86e594deeece4a
workflow-type: tm+mt
source-wordcount: '2510'
ht-degree: 1%

---

# ベストプラクティスと制限事項 {#acs-msdyn-best-practices}

## データの管理 {#acs-msdyn-manage-data}

連絡先エンティティとカスタムエンティティの同期の場合、この統合は&#x200B;**Microsoft Dynamics 365を真のソース**&#x200B;として扱います。  同期済み属性に対する変更は、Adobe Campaign Standardではなく、Dynamics 365でおこなう必要があります。  Campaignで変更がおこなわれると、同期が一方向におこなわれるので、同期中にCampaignで上書きされる可能性があります。

統合は、オプションで、Dynamics 365で連絡先が削除された場合にCampaignに対してプロファイル削除呼び出しを発行するように設定し、データの整合性を維持できます。 ただし、プロファイルの削除は、プライバシーの削除とは異なります。 Campaignでプライバシーを削除すると、Campaignプロファイルレコードと関連するログエントリが削除されます。一方、通常のプロファイル削除では、キャンペーンプロファイルレコードのみが削除され、キャンペーンログに残り物が残ります。 統合でプロファイル削除機能が有効になっている場合は、データ主体のプライバシーリクエストを適切に処理するために、追加の手順を実行する必要があります。 ](#manage-privacy-requests)の下の[プライバシーの節の手順を参照してください。

## プライバシー{#acs-msdyn-manage-privacy}

この統合は、Microsoft Dynamics 365とAdobe Campaign Standardの間でエンドユーザーデータを転送するように設計されています。 このデータには、エンドユーザーデータに含まれている場合は個人情報も含まれます。  データ管理者であるお客様の会社は、個人データの収集と使用に適用されるプライバシーに関する法令に準拠する責任を負います。

この統合は、エンドユーザーデータ（エンドユーザーデータに含まれる場合は個人情報を含む）をMicrosoft Dynamics 365とAdobe Campaign Standardの間で転送するように設計されています。 データ管理者であるお客様の会社は、個人データの収集と使用に適用されるプライバシーに関する法令に準拠する責任を負います。

統合では、（オプトアウトを除き）他のプライバシーリクエストを削除または処理するデータ主体のプライバシー（GDPRなど）は問題になりません。 プライバシーリクエストを処理する場合は、Microsoft Dynamics 365とCampaign(Adobe Experience Platform Privacy Service経由)の両方で、個別に処理する必要があります。

Dynamics 365で連絡先が削除されたときにCampaignに対して通常のプロファイル削除呼び出しを発行するように統合を設定している場合は、以下の手順に従う必要があります。 この処理中に、該当するレコードが更新されないことを確認します。

1. [Adobe Experience Platform Privacy Service](https://www.adobe.io/apis/experiencecloud/gdpr.html)にプライバシー削除リクエストを発行する

1. リクエストが正常に完了するまで監視する

1. レコードがCampaignインスタンスに存在しないことを確認する

1. （その後すぐに）Dynamics 365内でプライバシー削除を発行します

1. 両方のシステムからレコードが削除されたことを確認します

以下は、各システムでのアクセスおよび削除のプライバシー関連リクエストの実装に関するガイドへのリンクです。

* [Microsoft Dynamics 365](https://docs.microsoft.com/en-us/dynamics365/get-started/gdpr/)

* [Adobe Campaign Standard](https://experienceleague.adobe.com/docs/experience-platform/privacy/home.html)

>[!IMPORTANT]
>
>顧客のCampaignの使用に適した個人情報がCampaignのカスタムリソースレコードに含まれる場合は、そのレコードを対応するCampaignプロファイルレコード（直接または別のカスタムリソースを介して）にリンクし、プロファイルレコードのプライバシー関連の削除も可能にします。エンティティ間のリンクおよび削除のオプションは、リンクされたレコードをカスケード形式で削除できるように設定する必要があります。 個人情報は、プロファイルにリンクされていないカスタムリソースには入力しないでください。

## オプトアウト {#opt-out}

Microsoft Dynamics 365とCampaignの間でオプトアウト属性の違いと、各顧客のビジネス要件の違いにより、オプトアウトマッピングは、顧客が完了するための演習として残されています。  エンドユーザーのオプトアウト設定を維持し、オプトアウトしたチャネルを介した通信を受信しないように、オプトアウトがシステム間で適切にマッピングされるようにすることが重要です。

オプトアウトマッピングでは、次のみを使用できます。

* 「今後の連絡は不要」プレフィックスの付いたキャンペーン属性（例：Eメールによる今後の連絡は不要）、または

* CCPAの特定の属性

プロファイルエンティティフィールドに関する詳細は、[こちら](../../developing/using/datamodel-profile.md)を参照してください。

Dynamics 365では、ほとんどのオプトアウトフィールドに「donot」プレフィックスが付きますが、データタイプに互換性がある場合は、他の属性をオプトアウト用に利用することもできます。

統合をプロビジョニングする際に、ビジネスに必要なオプトアウト設定を指定できます。

* **単方向(Microsoft Dynamics 365～Campaign)**:Dynamics 365は、オプトアウトの情報源です。オプトアウト属性は、Dynamics 365からCampaign Standardへの一方向に同期されます
* **単方向（CampaignからMicrosoft Dynamics 365）**:Campaign Standardは、オプトアウトの情報源です。オプトアウト属性は、Campaign StandardからDynamics 365への一方向に同期されます
* **双方向**:Dynamics 365 ANDCampaign Standardはどちらも真実の源です。オプトアウト属性は、DynamicsとDynamics 365の間で双方向に同期されます。

また、システム間のオプトアウト同期を別のプロセスで管理する場合は、統合のオプトアウトデータフローを無効にできます。

双方向オプトアウト設定では、ロジックを使用して、両方のシステムに書き込む値を決定します。 このロジックでは、2つのシステム間のタイムスタンプ（Dynamics 365でのレコードレベルの変更、Campaignでの属性レベルの変更）を比較して、どのシステムが優先されるかを判断します。 Campaignに最新のタイムスタンプが含まれている場合は、Campaignの値が優先されます。 Dynamics 365に、より新しいタイムスタンプが含まれている場合、または等しい場合は、opt-out=TRUEが勝ちます（値の1つがTRUEの場合）。

[この節](../../integrating/using/d365-acs-self-service-app-data-sync.md#opt-in-out-wf)でオプトイン/オプションを選択する方法を説明します。

>[!NOTE]
>
>必要に応じて、Adobe Campaignのデフォルトの特定のタイポロジルールを確認し、ここで変更を加えて、送信されるすべての通信にその変更が正しく適用されるように更新してください。 例えば、オプトアウト設定のマッピングに受信者の意図/コミュニケーションの選択が正確に反映されるようにし、顧客の注文確認などの関係メッセージやトランザクションメッセージの配信を誤って中断しないようにしてください。

「**双方向**」または「**単方向（CampaignからMicrosoft Dynamics 365）**」オプトアウト設定を選択した場合、Campaignオプトアウトデータは、ワークフローを介してCampaign SFTPストレージ領域に定期的にエクスポートされます（以下の「Campaign SFTPの使用」を参照）。 Campaignオプトアウトワークフローの実行が停止した場合は、可能な限り早く手動で再起動し、オプトアウト同期が失敗する可能性を減らす必要があります。

>[!IMPORTANT]
>
>**双方向**&#x200B;または&#x200B;**単方向（CampaignからMicrosoft Dynamics 365）**&#x200B;オプトアウト設定が必要な場合は、Adobeのテクニカルコンタクトにリクエストを送信して、オプトアウトワークフローをCampaignインスタンスに設定する必要があります

## キャンペーンSFTPの使用

以下の使用例では、Campaign SFTPストレージを統合で使用する必要があります。  これらの使用例に対応するために、SFTPアカウントに十分なストレージ容量があることを確認する必要があります。 ライセンスされたSFTPストレージ容量を超えると、Campaign、統合、SFTPアカウントの機能使用が著しく低下する可能性があります。

| ユースケース | 説明 |
|---|---|
| 双方向および単方向（CampaignからMicrosoft Dynamics 365） | 双方向および単方向（CampaignからMicrosoft Dynamics 365）のオプトアウトデータフローでは、Campaign SFTPストレージを利用します。 Campaignワークフローで、増分変更をSFTPフォルダーにエクスポートします。 その後、統合によってレコードとプロセスが取得されます。 |
| オプトアウトログ | 統合のトラブルシューティングをおこなう際に、コネクタからの出力ログが役立ちます。 出力ログのオン/オフを切り替えることができます。 |


>[!IMPORTANT]
>
>SFTPフォルダーにアクセスしてダウンロードする情報は、ユーザーが担当します。 個人情報が含まれる場合は、プライバシーに関する法令に準拠する責任を負います。 [詳細情報](#acs-msdyn-manage-privacy)。

## データ管理

### 既存のキャンペーンデータ

この統合により、連絡先とカスタムエンティティがMicrosoft Dynamics 365からCampaignに同期されます。 統合以外で作成された（同期ジョブで作成されなかった）キャンペーンレコードは、統合では変更されません。統合の設定時に存在するキャンペーンレコードも含まれます。

この統合では、Campaignの&#x200B;**[!UICONTROL externalId]**&#x200B;フィールドを使用してDynamics 365の連絡先レコードとCampaignプロファイルのレコードを同期するので、Microsoft Dynamics 365から同期するレコードのMicrosoft Dynamics 365 **[!UICONTROL contactId]**&#x200B;をこのキャンペーンフィールド(**[!UICONTROL externalId]**)に入力する必要があります。  また、カスタムエンティティは、Microsoft Dynamics 365の一意のIDを使用して同期されます。 Campaignのカスタムエンティティでは、このID属性をテーブル列として含める必要があります。 externalId列は、この属性値の保存に使用できますが、Campaignのカスタムエンティティには必要ありません。

Microsoft Dynamics 365はまだ真のソースであり、統合によってDynamics 365側で更新が検出された場合にCampaignプロファイルデータが上書きされる可能性があることに注意してください。  また、既存のデプロイメントに応じて、統合を有効にするために必要な他の手順もあります。したがって、Adobeの技術担当者と緊密に連携することをお勧めします。

>[!NOTE]
>
>既存のお客様のデプロイメントは複雑なので、統合の計画と設定をおこなう際は、Adobeの技術担当者に相談することをお勧めします。

### データ同期の頻度

この統合では、Microsoft Dynamics 365で更新が発生した直後に「キュー」処理に対して更新を検出し、追加できるアーキテクチャを使用します（つまり、バッチ処理ではなくストリーミング処理）。 このため、データフローの実行頻度やスケジュールを指定する必要はありません。

この例外は、双方向およびCampaignからDynamics 365へのオプトアウトデータフローです。 これらのオプトアウト設定の場合、更新されたキャンペーンレコードは、キャンペーンワークフローを介して1日に1回SFTPにエクスポートされ、その後、統合ツールがファイルを読み取ってレコードを処理します。

### データ使用契約

EMEAまたはAPAC地域にいる場合、データの一部はこの統合の一環として米国で処理されます。 詳しくは、[こちらの節](../../reporting/using/about-dynamic-reports.md#dynamic-reporting-usage-agreement)を参照してください。

## ガードレールと制限

>[!IMPORTANT]
>
>特定のアクション（レコードの最初の取り込み、レコードデータの再生など） Microsoft Dynamics 365からAdobe Campaignインスタンスに大量のレコードが取り込まれる可能性があります。 パフォーマンスの問題のリスクを軽減するために、すべてのキャンペーンプロセス（マーケティングアクティビティがない、ワークフローが実行されていないなど）を停止することをお勧めします。 は、大量のレコードがCampaignに取り込まれるまでです。

### カスタムエンティティ

[Microsoft Dynamics 365-Adobe Campaign Standard統合](../../integrating/using/d365-acs-get-started.md)は、カスタムエンティティをサポートし、Dynamics 365のカスタムエンティティをCampaignの対応するカスタムリソースに同期できます。

この統合では、リンクされたテーブルとリンクされていないテーブルの両方がサポートされます。

カスタムエンティティのデータフローを設定する場合は、次の点に注意する必要があります。

* Campaignのカスタムリソースの作成と変更は機密性の高い操作で、エキスパートユーザーのみが実行する必要があります。
* カスタムエンティティのデータフローの場合、同期されたカスタムエンティティに対して、Dynamics 365内で変更の追跡を有効にする必要があります。
* Dynamics 365で親レコードとリンクされた子レコードが同じ時間に近い位置に作成された場合、統合の並列処理により、新しい子レコードが親レコードの前にCampaignに書き込まれる可能性が少しあります。

* **1基数単純リンク**&#x200B;オプションを使用して親と子がキャンペーン側でリンクされている場合、親レコードがCampaignに届くまで子レコードは非表示のままとなり、（UIまたはAPIを介して）アクセスできなくなります。

* （Campaignで&#x200B;**1基数単純リンク**&#x200B;を想定）Dynamics 365で子レコードが更新または削除され、その変更がCampaignに表示される前にCampaignに書き込まれた場合、その更新または削除はCampaignで処理されず、エラーがスローされます。 更新する場合、更新されたレコードを同期するには、問題となっているレコードをDynamics 365で再び更新する必要があります。 削除の場合、削除または更新するレコードがDynamics 365になくなったので、該当するレコードはCampaign側で個別に処理する必要があります。

* 非表示の子レコードがあり、そのレコードにアクセスできないと思われる状況が発生した場合は、基数のリンクの種類を&#x200B;**0または1基数の単純なリンク**&#x200B;に一時的に変更して、これらのレコードにアクセスできます。

Campaignのカスタムリソースの詳細な概要については、この節](../../developing/using/key-steps-to-add-a-resource.md)を参照してください。[

### 統合ガードレール

この統合の使用を計画する際は、次のガードレールを考慮する必要があります。 これらのガードレールを超えると思われる場合は、Adobeの技術担当者にお問い合わせください。

* 統合によって生成されるエンジン呼び出し量をサポートするには、適切なCampaignパッケージのライセンスが必要です。 ライセンスされたエンジン呼び出しの量を超えると、Campaignのパフォーマンスが低下する可能性があります。

   統合環境からのエンジンコールの量を見積もるのに役立つように、以下を使用します。

   * レコードの挿入（新しいレコード）:1エンジン呼び出し
   * レコードの削除：1エンジン呼び出し
   * レコードの更新：2回のエンジン呼び出し(宛先レコードがソースレコードと同一の場合（キャンペーンレコードに変更がない場合）は1回のみ呼び出し)

   Campaignエンジンの呼び出し量全体を見積もる場合、ランディングページ、WebApps、JSSP、API、モバイルアプリの登録など、他のエンジン呼び出し元を考慮に入れることが重要です。

   Adobe Campaign Standardパッケージの情報は、次の場所で確認できます。[https://helpx.adobe.com/legal/product-descriptions/campaign-standard.html](https://helpx.adobe.com/jp/legal/product-descriptions/campaign-standard.html)

* この統合では、Campaignのリソースに対する最初の同期で最大1,500万件のレコードの合計をサポートします。 増分同期は、Adobe Campaign Standardパッケージによって制限されます。

* 標準の統合機能には、最大20個のカスタムエンティティ（それぞれ最大50列）がサポートされています。

* 統合を実装する前に、カスタムリソースを作成して公開する必要があります。

* テーブルをリンクする際の最大テーブル深度は2です（例：table1->table2->table3）。

* この統合では、カスタムリソース1つにつき最大5つのリンクされた列をサポートします。 カスタムリソース間で複数の列をリンクすると、パフォーマンスに大きな影響を与える可能性があります。 **1基数シンプルリンクより** も、0または1基数シンプ **ルリンクの方が優先されます**。

* この統合では、Microsoft Dynamics 365のプリミティブデータ型(Boolean、Integer、Decimal、Double、String、DateTime、Date)とAdobe Campaign Standardのデータ型(integer、boolean、float、double、date、datetime、string)の変換がサポートされています。 より高度なデータ型は文字列として解釈され、そのまま同期されます。

* オンボーディングのメンテナンスウィンドウは、Adobeとお客様の間で確立する必要がある場合があります。

* 統合の使用量が大幅に増加したり「スパイク」が発生したりする場合（例えば、新しいレコードや更新されたレコードの急増）は、データ同期の遅延の原因となる場合があることに注意してください。

* 統合の一環として、Microsoft AzureとDynamics 365で統合前の設定手順を完了する必要があります。 このページの設定手順[を参照してください。](../../integrating/using/d365-acs-configure-d365.md)

* Dynamics 365およびCampaignデータモデルを統合に取り込み、維持することが期待されます。

### 統合の境界

この統合は、Microsoft Dynamics 365とCampaignの間の一般的なデータ移動の使用例を解決するように設計されていますが、各顧客に固有のすべての使用例に対処するためのものではありません。

* この統合では、プライバシー（GDPRなど）の削除は発生しません。 エンドユーザーのプライバシーリクエストを実行する責任は、お客様次第です。このようなリクエストは、(Adobe Experience Platform Privacy Service経由の)CampaignとDynamics 365で個別におこなう必要があります。 統合では、必要に応じて、データの同期に役立つように定期的な削除を発行できます。   詳しくは、「プライバシー」の節[を参照してください。](#manage-privacy-requests)

* オプトアウト情報（顧客が設定した場合）を除き、CampaignからDynamics 365にプロファイルまたはカスタムエンティティデータは同期されません。

* キャンペーンの購読管理（購読/購読解除）はネイティブではサポートされていません。

* Dynamics 365内からのCampaign電子メールキャンペーンの作成とトリガーはサポートされていません。

* この統合は、Dynamics 365とCampaign Standardデータモデルの間のデータのリモデリングを&#x200B;**サポートしません**。 統合では、1つのDynamics 365テーブルを1つのCampaignテーブルに同期する必要があります。
